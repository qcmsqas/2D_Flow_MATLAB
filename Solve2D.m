xmin=0;xmax=1;
ymin=0;ymax=1;
Nx=4;
Ny=4;
ux0=0.5;
rmu=1e-3;
ro=1e3;
tmax=200;
dt=0.01;
global u v us vs p Xc Yc Xf Yf Xv Yu;
setMesh(xmin,xmax,ymin,ymax,Nx,Ny);
%mdx=min([min(Xc(2:end)-Xc(1:end-1)),min(Yc(2:end)-Yc(1:end-1))]);
%dt=min([mdx,mdx*mdx/rmu]);
solveFlow(Nx,Ny,ux0,rmu,tmax,dt);
[pout,uout,vout,uvout] = get_out(Nx,Ny,ro,dt);
[X,Y]=meshgrid(Xc,Yc);X=X';Y=Y';
subplot(1,4,1);
surf(X,Y,pout,'edgecolor','none');
view(2);
caxis([-25,50]);
subplot(1,4,2);
surf(X,Y,uout,'edgecolor','none');
view(2);
%caxis([-25,50]);
subplot(1,4,3);
surf(X,Y,vout,'edgecolor','none');
view(2);
%caxis([-25,50]);
subplot(1,4,4);
surf(X,Y,uvout,'edgecolor','none');
view(2);
%caxis([-25,50]);
